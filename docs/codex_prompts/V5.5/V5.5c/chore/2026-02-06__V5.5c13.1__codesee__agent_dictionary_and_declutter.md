# Codex Prompt — V5.5c13 CodeSee: declutter `app_ui/codesee` + add Agent Dictionary docs

## Goal
Focus on **one area**: `app_ui/codesee/` (and its footprint in `app_ui/` imports).
1) Reduce clutter in `app_ui/codesee/` by moving a small set of “utility/storage/demo” modules into subpackages.
2) Create an **Agent Dictionary** (for agents like Codex/Gemini) that acts as a fast navigation map: what files do, where the real logic lives, and where to make edits.
3) Add minimal NAV anchors to the moved modules (comments only) to speed future agent work.

This is not meant to be the only reference; it’s a speed-up map for agents.

## Model / settings
Use **GPT‑5.3‑Codex** with **reasoning effort = Medium**.

## Touchlist

### 0) Baseline (no edits yet)
- Confirm CodeSee still passes:
  - `pytest -q tests/test_codesee_*`
  - `python -m compileall app_ui -q`

### 1) Add Agent Dictionary docs (new docs folder)
Create:
- `docs/agent_dictionary/INDEX.md`
- `docs/agent_dictionary/app_ui_codesee.md`

Optional (tiny, keep short):
- `docs/agent_dictionary/app_ui.md` (one-page high-level map; points to codesee page)

**Format requirements (optimize for agents):**
- Use short, scannable blocks.
- Each entry should be:
  - **Path**
  - **Role** (1 line)
  - **Key symbols** (classes/functions)
  - **Edit-when** (what changes belong here)
  - **NAV anchors** (if available, e.g. `screen.py [NAV-40]` lens palette)
  - **Do-not-touch / risks** (if any)

For `app_ui_codesee.md`, include these sections:
1) **Entry points**
   - `app_ui/main.py` imports: `CodeSeeScreen`, `CodeSeeWindow`, `runtime/*`
   - `app_ui/codesee/screen.py` (main screen, anchors)
   - `app_ui/codesee/window.py` (window wrapper)
2) **Current structure map**
   - `canvas/` (scene/items/view)
   - `runtime/` (hub/events/bus_bridge/hooks)
   - `collectors/` (atlas building)
   - `ui/` + `dialogs/` (palette + dialogs)
   - “core-ish” modules remaining at package root (list them)
3) **Where to implement common tasks**
   - UI tweaks (palette/dialogs/screen)
   - Runtime overlays/events
   - Snapshot/diff/crash handling
4) **Tests**
   - List the `tests/test_codesee_*` files and what they cover (short)

### 2) Declutter `app_ui/codesee/` by moving a SMALL set of modules into subpackages
We will NOT do a massive reorg. Move only these (they are self-contained and not imported from outside `app_ui/codesee`):
- `demo_graphs.py`  → `app_ui/codesee/demos/demo_graphs.py`
- `log_buffer.py`   → `app_ui/codesee/util/log_buffer.py`
- `layout_store.py` → `app_ui/codesee/storage/layout_store.py`
- `snapshot_io.py`  → `app_ui/codesee/storage/snapshot_io.py`
- `snapshot_index.py` → `app_ui/codesee/storage/snapshot_index.py`
- `diagnostics_dialog.py` → `app_ui/codesee/dialogs/diagnostics_dialog.py`

Create new packages (with `__init__.py`):
- `app_ui/codesee/demos/`
- `app_ui/codesee/util/`
- `app_ui/codesee/storage/`

**Update imports** within `app_ui/codesee/` accordingly:
- In `screen.py`, change:
  - `diagnostics_dialog` import to the new dialogs location
  - `layout_store`, `snapshot_io`, `snapshot_index`, `log_buffer`, `demo_graphs` to their new packages (only if referenced)
- Update any other codesee modules that import these (search/replace carefully).

**Keep external imports stable:**
- Do NOT move `expectations.py` or `crash_io.py` in this slice (they’re imported from other `app_ui` screens).
- Do NOT rename `CodeSeeScreen` / `CodeSeeWindow` or change their import paths.

If you discover any non-codesee imports of these moved modules (unlikely), add a tiny compatibility shim at the old path that re-exports from the new location. Prefer to avoid shims if not needed.

### 3) Add minimal NAV anchors to the moved modules (comments-only)
Add a short NAV header (like `app_ui/main.py`) to each moved file:
- `app_ui/codesee/demos/demo_graphs.py`
- `app_ui/codesee/util/log_buffer.py`
- `app_ui/codesee/storage/layout_store.py`
- `app_ui/codesee/storage/snapshot_io.py`
- `app_ui/codesee/storage/snapshot_index.py`
- `app_ui/codesee/dialogs/diagnostics_dialog.py`

Keep it small (these are short files):
- `[NAV-00] Imports / constants`
- `[NAV-10] Public API` (main functions/classes)
- `[NAV-99] end`

### 4) Update the Agent Dictionary after moves
Update `docs/agent_dictionary/app_ui_codesee.md`:
- reflect the new subpackages (`storage/`, `util/`, `demos/`)
- point agents to the **new canonical paths** (not old ones)

### 5) Prompt-index hygiene
Add this prompt file to:
- `docs/codex_prompts/V5.5/V5.5c/chore/`
and append an entry to `docs/codex_prompts/INDEX.md` under `V5.5c → chore/`.

## Forbidden list
- No behavior changes beyond necessary import updates caused by moving files.
- No reformatting whole files; keep diffs tight.
- Do NOT reorganize `app_ui/screens/` or other app areas in this slice.
- Do NOT attempt repo-wide NAV annotations now (we’re scoped to CodeSee only).

## Self-verification (must do)
Automated:
1) `pytest -q tests/test_codesee_*`
2) `python -m compileall app_ui -q`

Manual (quick):
- Open CodeSee screen.
- Open “More → Diagnostics” (ensure dialog still opens).
- Verify Lens Palette still opens (dock/float/pin once).

## Git checkpoints
Prefer two commits:

Commit A (docs only):
```bash
git add -A
git commit -m "docs(V5.5c13) add agent dictionary for codesee"
git push
```

Commit B (code moves + NAV):
```bash
git add -A
git commit -m "chore(V5.5c13) declutter codesee modules into subpackages"
git push
```
