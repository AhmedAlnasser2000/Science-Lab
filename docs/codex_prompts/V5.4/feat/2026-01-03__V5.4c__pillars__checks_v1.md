# GPT-5.2-Codex — reasoning: Medium
Justification: Multi-file but contained changes (CI workflow + pillars harness + tests). Medium is enough; keep cost controlled.

## Goal
Implement **V5.4c**: make the Pillars harness *actionable* (not just scaffold) while keeping it headless and safe.
- The report must enumerate **all 12 pillars** and produce deterministic PASS/FAIL/SKIP results.
- Add **two real pillar checks** that are robust across refactors:
  1) **P3 CI baseline (Windows-first)**: validate the CI workflow exists and enforces compileall + pillars pytest on PRs.
  2) **P10 Runtime data hygiene**: verify runtime outputs under `data/` are gitignored (no repo pollution).
- Tighten CI “Compile” step so it **fails** if it compiled **zero** directories (addresses Cursor bot comment).

## Touchlist
- `.github/workflows/ci.yml`
- `tools/pillars_report.py` (or wherever the pillars report schema + checks live)
- `tools/pillars_harness.py` (CLI harness; only as needed)
- `tests/pillars/*` (expand unit coverage; keep fast)
- `docs/codex_prompts/INDEX.md` (append new entry for this prompt doc)

## Forbidden list
- No GUI / PyQt6 runtime execution in CI (no `python -m app_ui.main` in Actions).
- No changes to Code See runtime features in this step.
- No new long-running tests; keep `tests/pillars` fast (< 2s locally).
- No broad refactors outside the files listed above.

## Implementation details

### 1) CI: Make compile step fail if no directories were compiled
In `.github/workflows/ci.yml`, update the inline Python compile snippet so it errors when `roots` is empty.

Current logic filters non-existent paths and then `all(...)` on an empty list which returns True.
Fix by adding:
- If `not roots`: print a clear message and `sys.exit(1)`.
- Also keep the existing `sys.exit(0 if ok else 1)` behavior.

Keep the `cache-dependency-path: requirements-dev.txt` fix intact.

### 2) Pillars: Ensure the report enumerates all 12 pillars
Add/ensure a canonical list of the 12 pillars (IDs 1–12) in `tools/pillars_report.py` (or an adjacent module).
Each pillar entry should include:
- `id` (1..12)
- `title`
- `status` in {`PASS`,`FAIL`,`SKIP`}
- `reason` (short human-readable)
- optional `evidence` (list of strings)
- optional `details` (dict for extra machine-readable info)

If some pillars aren’t implemented yet, they should be `SKIP` (not missing).

Use these titles verbatim:
1. Versioning & build identity
2. Schema versions + migrations
3. CI baseline (Windows-first)
4. Release & packaging pipeline
5. Crash capture + Safe Viewer
6. Logging & structured events
7. Telemetry / metrics (opt-in)
8. Activity spans + runtime tracing contract
9. Config layering & reproducibility
10. Runtime data hygiene (data layout + .gitignore)
11. Plugin/pack dependency metadata
12. Security & capability boundaries

### 3) Implement real checks

#### Pillar 3: CI baseline
Implement a check that:
- Confirms `.github/workflows/ci.yml` exists
- Confirms it references:
  - `actions/setup-python@v5`
  - `python-version: "3.12"`
  - `python -m compileall` OR the current inline compile snippet
  - `python -m pytest -q tests/pillars`
- Returns PASS if all are found; otherwise FAIL with evidence listing what was missing.

This check should be resilient to minor formatting differences (use substring search, not strict YAML parsing).

#### Pillar 10: Runtime data hygiene
Implement a check that validates runtime outputs won’t pollute git:
- Confirm `.gitignore` exists and includes a rule that ignores `data/` (or at least `data/roaming/` and `data/workspaces/`).
- Additionally, do a practical “gitignore works” probe:
  - Create a temp file under `data/roaming/pillars_reports/_gitignore_probe.tmp`
  - Run `git status --porcelain` and assert the probe file does **not** appear
  - Remove the probe file afterward (always, even if failing)
- If git isn’t available, return SKIP with reason “git not available” rather than failing.

### 4) Tests
Expand `tests/pillars` to cover:
- Report contains exactly 12 pillars with IDs 1..12.
- Pillar 3 check returns PASS in normal repo state (this repo should satisfy it after V5.4b merge).
- Pillar 10 check returns PASS (probe file does not show up in `git status`), OR SKIP if git not found.

Keep tests OS-agnostic; avoid assumptions about shell availability.

### 5) CLI harness output remains compatible
Do not break existing harness behavior:
- It should still write a report JSON to the chosen output folder.
- It should still maintain a “latest” copy under `data/roaming/...` for UI pickup if that behavior exists.

## Self-verify
From repo root (Windows):
1) `python -m compileall app_ui diagnostics tools`
2) `python -m pytest -q tests/pillars`
3) `python tools/pillars_harness.py --out data/roaming/pillars_reports_devcheck`
4) Verify `git status --porcelain` stays clean after running the harness (no new tracked/untracked noise).

## Manual checks (UI)
1) Launch app: `python -m app_ui.main`
2) Open **System Health → Overview**
3) Confirm “Pillars Status” card still appears and opens the report folder.
4) Generate a report via CLI and confirm UI finds the latest report.

## Repo bookkeeping
Append a new entry to `docs/codex_prompts/INDEX.md`:
- Date: 2026-01-03
- Version: V5.4c
- File: `2026-01-03__V5.4c__pillars__checks_v1.md`
- Purpose: “Add first actionable pillar checks (CI baseline + runtime data hygiene) and tighten CI compile step.”
- Commit: TBD (fill after merge)
